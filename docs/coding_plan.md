# 家装AI智库 - 编码计划

本文档根据《家装AI智库项目概述》制定，旨在提供一个分阶段、按顺序执行的编码计划。

## 阶段一：环境搭建与数据库基础 (预计 1-2 周)

**目标:** 搭建项目基础结构，完成数据库设计和初始化。

1.  **项目初始化:**
    *   [ ] 1.1 使用 `create-next-app` 初始化前端 Next.js 项目。
    *   [ ] 1.2 初始化后端 Node.js 项目 (例如使用 Express 或 Koa 框架)。
    *   [ ] 1.3 配置项目结构 (例如 `frontend`, `backend` 目录)。
    *   [ ] 1.4 设置版本控制 (Git)。
2.  **Cloudflare 配置:**
    *   [ ] 2.1 确认 Cloudflare 账户、D1 数据库、R2 存储桶、KV 命名空间已准备就绪。
    *   [ ] 2.2 在后端项目中配置 D1 数据库连接凭证和 SDK。
    *   [ ] 2.3 在后端项目中配置 R2 存储桶连接凭证和 SDK (或确定前端直传方案)。
    *   [ ] 2.4 (可选) 在后端项目中配置 KV 命名空间连接凭证和 SDK。
3.  **数据库设计与实现 (D1):**
    *   [ ] 3.1 最终确定 `users`, `categories`, `articles` 表的详细结构 (字段、类型、约束、索引)。
    *   [ ] 3.2 编写 SQL `CREATE TABLE` 语句。
    *   [ ] 3.3 使用 Cloudflare Wrangler 或 D1 控制台执行 SQL 语句，创建表结构。
    *   [ ] 3.4 (可选) 考虑使用数据库迁移工具 (如 `drizzle-kit` 配合 Cloudflare D1)。
    *   [ ] 3.5 添加初始管理员用户数据到 `users` 表。
    *   [ ] 3.6 添加初始分类数据到 `categories` 表。

## 阶段二：后端 API 开发 (核心功能) (预计 3-4 周)

**目标:** 开发核心的后台管理 API 接口。

1.  **认证与授权:**
    *   [ ] 4.1 实现管理员登录 API (`POST /api/auth/login`)，验证用户名密码，生成 Token (如 JWT)。
    *   [ ] 4.2 实现管理员登出 API (`POST /api/auth/logout`)。
    *   [ ] 4.3 实现认证中间件，保护需要登录才能访问的 API 路由。
2.  **分类管理 API:**
    *   [ ] 5.1 实现获取所有分类列表 API (`GET /api/categories`)。
    *   [ ] 5.2 实现获取单个分类详情 API (`GET /api/categories/:id`)。
    *   [ ] 5.3 实现创建分类 API (`POST /api/categories`)。
    *   [ ] 5.4 实现更新分类 API (`PUT /api/categories/:id`)。
    *   [ ] 5.5 实现删除分类 API (`DELETE /api/categories/:id`)。
3.  **文章管理 API:**
    *   [ ] 6.1 实现获取文章列表 API (`GET /api/articles`，支持分页、按分类过滤、按时间排序)。
    *   [ ] 6.2 实现获取树形结构文章列表 API (`GET /api/articles/tree`，用于 AI 相关纪事)。
    *   [ ] 6.3 实现获取单个文章详情 API (`GET /api/articles/:id` 或 `GET /api/articles/slug/:slug`)。
    *   [ ] 6.4 实现创建文章 API (`POST /api/articles`，处理 `parent_id`, `category_id`, R2 文件引用)。
    *   [ ] 6.5 实现更新文章 API (`PUT /api/articles/:id`)。
    *   [ ] 6.6 实现删除文章 API (`DELETE /api/articles/:id`)。
4.  **用户管理 API (管理员):**
    *   [ ] 7.1 实现获取用户列表 API (`GET /api/users`)。
    *   [ ] 7.2 实现创建用户 API (`POST /api/users`)。
    *   [ ] 7.3 实现更新用户 API (`PUT /api/users/:id`)。
    *   [ ] 7.4 实现删除用户 API (`DELETE /api/users/:id`)。
5.  **文件上传 API (R2):**
    *   [ ] 8.1 (如果后端处理上传) 实现文件上传接口 (`POST /api/upload`)，将文件存入 R2 并返回文件 URL。
    *   [ ] 8.2 (如果前端直传) 后端提供获取 R2 上传预签名 URL 的接口。

## 阶段三：前端开发 (后台管理界面) (预计 3-4 周)

**目标:** 开发功能完善的后台管理界面。

1.  **基础布局与认证:**
    *   [ ] 9.1 搭建后台管理的基础布局 (侧边栏导航、内容区域)。
    *   [ ] 9.2 实现登录页面，调用登录 API，处理 Token 存储和路由跳转。
    *   [ ] 9.3 实现路由守卫，未登录用户访问后台页面时跳转到登录页。
    *   [ ] 9.4 实现登出功能。
2.  **仪表盘:**
    *   [ ] 10.1 (可选) 设计并实现简单的仪表盘页面，展示统计信息。
3.  **分类管理页面:**
    *   [ ] 11.1 实现分类列表展示页面，调用 `GET /api/categories`。
    *   [ ] 11.2 实现创建/编辑分类的表单和弹窗，调用 `POST/PUT /api/categories`。
    *   [ ] 11.3 实现删除分类功能，调用 `DELETE /api/categories/:id`。
4.  **文章管理页面:**
    *   [ ] 12.1 实现文章列表展示页面 (表格形式)，调用 `GET /api/articles`。
    *   [ ] 12.2 实现创建/编辑文章页面。
    *   [ ] 12.3 集成富文本编辑器 (如 Tiptap, Quill, TinyMCE)。
    *   [ ] 12.4 实现文章内容保存，调用 `POST/PUT /api/articles`。
    *   [ ] 12.5 实现文件上传功能 (调用后端上传接口或前端直传 R2)。
    *   [ ] 12.6 实现删除文章功能，调用 `DELETE /api/articles/:id`。
5.  **用户管理页面:**
    *   [ ] 13.1 实现用户列表展示页面，调用 `GET /api/users`。
    *   [ ] 13.2 实现创建/编辑用户的表单和弹窗，调用 `POST/PUT /api/users`。
    *   [ ] 13.3 实现删除用户功能，调用 `DELETE /api/users/:id`。

## 阶段四：前端开发 (前台展示界面) (预计 2-3 周)

**目标:** 开发面向普通用户的前台展示页面。

1.  **核心布局:**
    *   [ ] 14.1 实现网站的整体布局 (页头、页脚、主导航)。
    *   [ ] 14.2 设计并实现网站的整体 UI 风格。
2.  **AI 相关纪事页面:**
    *   [ ] 15.1 调用 `GET /api/articles/tree` 获取树形数据。
    *   [ ] 15.2 使用合适的 UI 组件 (如 Ant Design Tree) 展示树形内容，支持展开/折叠。
3.  **AI 家装应用页面:**
    *   [ ] 16.1 实现分类导航组件。
    *   [ ] 16.2 实现文章列表组件，根据选择的分类调用 `GET /api/articles`。
    *   [ ] 16.3 实现文章详情页面，调用 `GET /api/articles/:id` 或 `GET /api/articles/slug/:slug` 展示文章内容。
4.  **关于我们页面:**
    *   [ ] 17.1 实现静态的“关于我们”页面，展示团队介绍和服务信息。
    *   [ ] 17.2 (可选) 将部分内容改为从后台获取。

## 阶段五：集成、测试与部署 (预计 2-3 周)

**目标:** 完成系统测试，修复 Bug，并将应用部署上线。

1.  **集成测试:**
    *   [ ] 18.1 进行前后端接口联调测试。
    *   [ ] 18.2 测试所有核心功能流程 (用户浏览、管理员操作)。
2.  **单元与集成测试:**
    *   [ ] 19.1 (推荐) 为后端关键服务和逻辑编写单元测试。
    *   [ ] 19.2 (推荐) 为前端关键组件编写单元测试。
    *   [ ] 19.3 (推荐) 编写端到端测试用例 (如使用 Playwright 或 Cypress)。
3.  **性能与安全:**
    *   [ ] 20.1 进行前端页面加载性能测试和优化。
    *   [ ] 20.2 进行后端 API 性能测试。
    *   [ ] 20.3 进行基础的安全测试 (如检查 SQL 注入、XSS、CSRF 风险)。
4.  **部署准备:**
    *   [ ] 21.1 编写部署文档。
    *   [ ] 21.2 配置生产环境变量。
    *   [ ] 21.3 (推荐) 配置 CI/CD 流程 (如使用 GitHub Actions)。
5.  **部署:**
    *   [ ] 22.1 将后端 Node.js 应用部署到 Cloudflare Workers (或其他平台)。
    *   [ ] 22.2 将前端 Next.js 应用部署到 Cloudflare Pages。
    *   [ ] 22.3 配置域名和 DNS。
6.  **最终测试与上线:**
    *   [ ] 23.1 在生产环境进行最终测试。
    *   [ ] 23.2 正式上线。

**注意:**

*   以上时间预估仅供参考，实际开发时间可能因具体情况调整。
*   建议在每个阶段结束后进行代码评审和总结。
*   鼓励编写必要的文档（API 文档、组件文档等）。
*   次要功能（搜索、用户反馈、多语言）可在核心功能完成后根据优先级安排。